{{define "showcase"}}
{{/* Generic showcase template - works for calendar events and other services */}}

<p style="margin-bottom: 20px; color: #666;">
    Click any example below to test the generated URLs:
</p>

{{range $index, $case := .TestCases}}
<div class="showcase-item">
    <h3>{{$case.GetName}}</h3>

    {{if $case.GetDescription}}
    <p style="color: #666; font-size: 14px; margin-bottom: 10px;">{{$case.GetDescription}}</p>
    {{end}}

    <div class="details">
        {{/* Calendar-specific details - now using Data map */}}
        {{if $case.Data}}
            {{if index $case.Data "title"}}<strong>Title:</strong> {{index $case.Data "title"}}<br>{{end}}
            {{if index $case.Data "start"}}
            <strong>Start:</strong> {{index $case.Data "start"}}
            {{if index $case.Data "end"}} - {{index $case.Data "end"}}{{end}}
            {{if index $case.Data "allDay"}} (All Day){{end}}
            <br>
            {{end}}
            {{if index $case.Data "location"}}<strong>Location:</strong> {{index $case.Data "location"}}<br>{{end}}
            {{if index $case.Data "description"}}<strong>Description:</strong> {{index $case.Data "description"}}<br>{{end}}
        {{end}}
    </div>

    {{/* Generate URL using form action - properly encode arrays and objects */}}
    <form method="POST" action="/{{$.Platform}}/{{$.AppType}}" target="_blank" style="margin-top: 10px;">
        {{range $key, $value := $case.Data}}
            {{if eq (printf "%T" $value) "[]interface {}"}}
                {{/* Array: encode each item */}}
                {{range $index, $item := $value}}
                    {{if eq (printf "%T" $item) "map[string]interface {}"}}
                        {{/* Array of objects */}}
                        {{range $subkey, $subvalue := $item}}
                            <input type="hidden" name="{{$key}}[{{$index}}].{{$subkey}}" value="{{$subvalue}}">
                        {{end}}
                    {{else}}
                        {{/* Array of primitives */}}
                        <input type="hidden" name="{{$key}}[{{$index}}]" value="{{$item}}">
                    {{end}}
                {{end}}
            {{else if eq (printf "%T" $value) "map[string]interface {}"}}
                {{/* Nested object */}}
                {{range $subkey, $subvalue := $value}}
                    <input type="hidden" name="{{$key}}.{{$subkey}}" value="{{$subvalue}}">
                {{end}}
            {{else}}
                {{/* Simple value */}}
                <input type="hidden" name="{{$key}}" value="{{$value}}">
            {{end}}
        {{end}}
        <div class="actions">
            <button type="submit" class="btn-open">Generate & Open</button>
        </div>
    </form>
</div>
{{end}}
{{end}}
